<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>9&nbsp; Code Workflow Team Agreements – Stanford Health Policy Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/10-pre-flight-checklist.html" rel="next">
<link href="../chapters/08-code-review.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-0dd2bd5de344125cf763a379ddc3eb04.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/09-code-workflow-agreements.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Code Workflow Team Agreements</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Stanford Health Policy Data Science</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab Manual</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-culture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Lab Culture</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-policies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">General Policies</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-funding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Funding</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Computing Resources</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-conferences.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Conferences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07-publications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Publications</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/08-code-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Code Review</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/09-code-workflow-agreements.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Code Workflow Team Agreements</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/10-pre-flight-checklist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Pre-Flight Checklist for Publications</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#team-agreements" id="toc-team-agreements" class="nav-link active" data-scroll-target="#team-agreements"><span class="header-section-number">9.1</span> Team Agreements</a></li>
  <li><a href="#sec-code-style" id="toc-sec-code-style" class="nav-link" data-scroll-target="#sec-code-style"><span class="header-section-number">9.2</span> Code Style</a></li>
  <li><a href="#sec-naming" id="toc-sec-naming" class="nav-link" data-scroll-target="#sec-naming"><span class="header-section-number">9.3</span> Naming Things</a></li>
  <li><a href="#project-organization" id="toc-project-organization" class="nav-link" data-scroll-target="#project-organization"><span class="header-section-number">9.4</span> Project Organization</a>
  <ul class="collapse">
  <li><a href="#dont-include-sensitive-information-on-git-and-github" id="toc-dont-include-sensitive-information-on-git-and-github" class="nav-link" data-scroll-target="#dont-include-sensitive-information-on-git-and-github"><span class="header-section-number">9.4.1</span> Don’t Include Sensitive Information on Git and GitHub</a></li>
  <li><a href="#dont-include-absolute-directories-that-are-not-accessible-to-others" id="toc-dont-include-absolute-directories-that-are-not-accessible-to-others" class="nav-link" data-scroll-target="#dont-include-absolute-directories-that-are-not-accessible-to-others"><span class="header-section-number">9.4.2</span> Don’t Include Absolute Directories That Are Not Accessible to Others</a></li>
  <li><a href="#be-clear-about-what-can-only-be-run-in-protected-environments" id="toc-be-clear-about-what-can-only-be-run-in-protected-environments" class="nav-link" data-scroll-target="#be-clear-about-what-can-only-be-run-in-protected-environments"><span class="header-section-number">9.4.3</span> Be Clear About What Can Only Be Run In Protected Environments</a></li>
  </ul></li>
  <li><a href="#sec-quarto" id="toc-sec-quarto" class="nav-link" data-scroll-target="#sec-quarto"><span class="header-section-number">9.5</span> Generate Reproducible Documents with Quarto</a></li>
  <li><a href="#sec-git-github" id="toc-sec-git-github" class="nav-link" data-scroll-target="#sec-git-github"><span class="header-section-number">9.6</span> Use Git and GitHub</a>
  <ul class="collapse">
  <li><a href="#git-workflow" id="toc-git-workflow" class="nav-link" data-scroll-target="#git-workflow"><span class="header-section-number">9.6.1</span> Git Workflow</a></li>
  <li><a href="#transferring-repositories" id="toc-transferring-repositories" class="nav-link" data-scroll-target="#transferring-repositories"><span class="header-section-number">9.6.2</span> Transferring Repositories</a></li>
  <li><a href="#sec-gh-release" id="toc-sec-gh-release" class="nav-link" data-scroll-target="#sec-gh-release"><span class="header-section-number">9.6.3</span> Release on GitHub</a></li>
  </ul></li>
  <li><a href="#documentation" id="toc-documentation" class="nav-link" data-scroll-target="#documentation"><span class="header-section-number">9.7</span> Documentation</a>
  <ul class="collapse">
  <li><a href="#a-note-about-comments" id="toc-a-note-about-comments" class="nav-link" data-scroll-target="#a-note-about-comments"><span class="header-section-number">9.7.1</span> A Note about Comments</a></li>
  <li><a href="#sec-readme" id="toc-sec-readme" class="nav-link" data-scroll-target="#sec-readme"><span class="header-section-number">9.7.2</span> <code>README</code></a></li>
  </ul></li>
  <li><a href="#sec-running-code" id="toc-sec-running-code" class="nav-link" data-scroll-target="#sec-running-code"><span class="header-section-number">9.8</span> Running Code</a>
  <ul class="collapse">
  <li><a href="#use-a-blank-slate" id="toc-use-a-blank-slate" class="nav-link" data-scroll-target="#use-a-blank-slate"><span class="header-section-number">9.8.1</span> Use a Blank Slate</a></li>
  <li><a href="#sec-pipelines" id="toc-sec-pipelines" class="nav-link" data-scroll-target="#sec-pipelines"><span class="header-section-number">9.8.2</span> Pipelines</a></li>
  <li><a href="#provide-guidance-on-how-to-run-your-code" id="toc-provide-guidance-on-how-to-run-your-code" class="nav-link" data-scroll-target="#provide-guidance-on-how-to-run-your-code"><span class="header-section-number">9.8.3</span> Provide Guidance on How to Run Your Code</a></li>
  </ul></li>
  <li><a href="#sec-pkg-env" id="toc-sec-pkg-env" class="nav-link" data-scroll-target="#sec-pkg-env"><span class="header-section-number">9.9</span> Lock your Package Versions</a></li>
  <li><a href="#sec-opt-in" id="toc-sec-opt-in" class="nav-link" data-scroll-target="#sec-opt-in"><span class="header-section-number">9.10</span> Opt-in Workflows</a>
  <ul class="collapse">
  <li><a href="#sec-tests" id="toc-sec-tests" class="nav-link" data-scroll-target="#sec-tests"><span class="header-section-number">9.10.1</span> Testing</a></li>
  <li><a href="#sec-docker" id="toc-sec-docker" class="nav-link" data-scroll-target="#sec-docker"><span class="header-section-number">9.10.2</span> Docker</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-agreements" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Code Workflow Team Agreements</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="team-agreements" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="team-agreements"><span class="header-section-number">9.1</span> Team Agreements</h2>
<p>This chapter documents the code workflow team agreements for our Lab. By team agreements, we mean a set of coding principles and workflows we have all agreed to adhere to. This is a living document: we can update as the team and coding ecosystems also change over time. If you have concerns or suggestions about our workflows, feel free to propose alternatives for the team to consider collectively.</p>
<p>We focus on workflows that allow individual members freedom to code how they prefer while maintaining reproducibility and ease of collaboration. Thus, we don’t tell you which language to use or, for the most part, which tools to use within a given language (unless there is a key tool we use to maintain the agreements).</p>
<p>Currently, most of our team uses R, Python, or both. Thus, we offer language-specific guidance for those two languages. We’ll add relevant recommendations if other languages become more prominent in the team. We also offer guidance on code style for SQL.</p>
<p>Throughout this document, we’ll organize language-specific guidance in tab sets like this:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>This is how we do things in R.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>This is how we do things in Python.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Contact Malcolm for support if you want help setting up or using any guidelines in this document.</p>
</div>
</div>
</section>
<section id="sec-code-style" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="sec-code-style"><span class="header-section-number">9.2</span> Code Style</h2>
<p>Consistency of code style is essential for collaboration. It speeds up the reading of code and reduces debates on what code should look like. We prefer automated styling tools such that you can write however you like and quickly follow the team style guide by running the tool.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">SQL</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>R code should follow the <a href="https://style.tidyverse.org/index.html">Tidyverse style guide</a>, automatically styled by the styler package. Despite the name, this guide also applies to non-Tidyverse code, including base R and data.table.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># style all R-related files in the current directory</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>styler<span class="sc">::</span><span class="fu">style_dir</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Note that you should run styler interactively in the console, not in one of your R scripts.</p>
<p>Styler also has a helpful add-in for RStudio to let you style the active file, a code selection, etc.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>For Python, we use the <a href="https://black.readthedocs.io/en/stable/the_black_code_style/current_style.html">Black style guide</a>. Black comes with its own styler, but <a href="https://docs.astral.sh/ruff/">Ruff</a> implements it more quickly and flexibly, so that’s our recommendation. Either tool is fine in practice, though, as it should result in the same styling.</p>
<p>Ruff is installable through pip:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install ruff</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Run this command in the terminal to format the Python code in your directory:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ruff</span> format</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Note: Quarto files are not widely supported yet. See this issue for ruff: <a href="https://github.com/astral-sh/ruff/issues/6140" class="uri">https://github.com/astral-sh/ruff/issues/6140</a>.</em></p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>For SQL queries, we use the <a href="https://docs.sqlfluff.com/en/stable/reference/rules.html">SQLFluff</a>.</p>
<p>SQLFluff is installable through pip:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install sqlfluff</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Run this command in the terminal to format a given SQL file (here, <code>query.sql</code>):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">sqlfluff</span> fix query.sql <span class="at">--dialect</span> bigquery</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This example uses the Google BigQuery dialect, as many of our lab members use via Nero GCP.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We do not currently require a linter, but they can be handy to analyze your code for areas of improvement.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false" href="">SQL</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>In R, use <a href="https://lintr.r-lib.org/">lintr</a>. Linting works particularly well in RStudio, which will tag lines of code with specific suggestions.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>lintr<span class="sc">::</span><span class="fu">lint_dir</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>In Python, use <a href="https://docs.astral.sh/ruff/linter/">Ruff’s linter</a>.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ruff check</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>You can also automatically fix any suggestions or re-lint on changes.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lint and fix</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ruff check <span class="op">--</span>fix</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># re-lint when files change</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>ruff check <span class="op">--</span>watch</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p><a href="https://docs.sqlfluff.com/en/stable/reference/rules.html">SQLFluff</a> is actually a linter. <code>sqlfluff fix</code> automatically addresses formating and other linting rules. When you run it, you might also see other linting rules that are not automatically fixable. You can see the lints without trying to fix them with:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">sqlfluff</span> lint query.sql <span class="at">--dialect</span> bigquery</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-naming" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="sec-naming"><span class="header-section-number">9.3</span> Naming Things</h2>
<p>Naming things is an aspect of code style, but it merits a little extra attention because it is important to readability. In general, strive to make your code <em>self-documenting</em>, e.g., someone else should be able to read your code and understand what it’s doing without talking to you about it. Self-documenting is easier said than done, so code clearness is an essential type of feedback in code review.</p>
<p>Use descriptive names for objects in code, e.g., <code>model_results</code> rather than <code>out</code> or <code>kangaroo_data</code> rather than <code>k</code>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>It’s OK to use terse names where the meaning is generally understood, like <code>n</code> for counts or <code>i</code> and <code>j</code> for loop counters.</p>
</div>
</div>
<p>Similarly, for functions, describe what the function is doing, preferably in verb format, e.g., <code>simulate_data()</code> is better than <code>f()</code> or <code>data_simulator()</code></p>
<p>For both R and Python, prefer <code>snake_case</code> over <code>camelCase</code> and other naming style conventions unless otherwise appropriate, e.g., the name of a class for object-oriented programming in Python.</p>
</section>
<section id="project-organization" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="project-organization"><span class="header-section-number">9.4</span> Project Organization</h2>
<p>We try to be flexible about project organization, as being too prescriptive often backfires. The rule of thumb is to try to make it obvious where everything is by using descriptive folder and file names, e.g., <code>R/</code> or <code>scripts/</code> to organize source code and <code>output</code> or <code>reports</code> to organize research outputs. You should also include guidance on the organization of your project in a <code>README</code> (see <a href="#sec-readme" class="quarto-xref"><span>Section 9.7.2</span></a>).</p>
<p>For instance, an R project might look like this:</p>
<pre><code>R/
figures/
reports/
my_project.Rproj</code></pre>
<p>or like this:</p>
<pre><code>sql/
functions/
run.R
my_project.Rproj</code></pre>
<p>Both setups are understandable and reasonable; the vital part is that users know where to find important files and how to use them.</p>
<p>There are a few tools that will help you set up a project.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>RStudio supports the idea of <em>RStudio Projects</em>. These are handy setups because they set your working directory wherever your project is on your computer. See <a href="https://www.tidyverse.org/blog/2017/12/workflow-vs-script/">Project-Oriented Workflows</a> for more.</p>
<p>Use the RStudio interface to create a new project or create one in the console with <code>usethis::create_project("/path/to/your/new/project")</code>.</p>
</div>
</div>
<p>We also have a couple of essential guidelines for what is in a project.</p>
<section id="dont-include-sensitive-information-on-git-and-github" class="level3" data-number="9.4.1">
<h3 data-number="9.4.1" class="anchored" data-anchor-id="dont-include-sensitive-information-on-git-and-github"><span class="header-section-number">9.4.1</span> Don’t Include Sensitive Information on Git and GitHub</h3>
<p><a href="https://docs.github.com/en/get-started/getting-started-with-git/ignoring-files">.gitignore</a> any sensitive data. For instance, your <code>.gitignore</code> file should contain lines for <code>data/</code> and <code>data-raw/</code> if those two folders contain sensitive data. Another common source of information leaks is cached data, such as Jupyter checkpoints or a knitr cache.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For R users, consider running <code>usethis::git_vaccinate()</code> in the console. Running this command will add standard R-related files that shouldn’t be in version control to your global gitignore. It won’t protect you from including sensitive data, but it serves as a backup configuration for files that usually don’t need to be included.</p>
<p>usethis also has a function called <code>use_git_ignore()</code> for adding files and folders to <code>.gitignore</code>, which might feel more natural to the R workflow.</p>
</div>
</div>
<p>A project that has sensitive data and uses Jupyter might have a <code>.gitignore</code> file in the root directory that looks like this:</p>
<pre><code>data/
.ipynb_checkpoints
*/__pycache__</code></pre>
<p>Here, <code>data/</code> is ignored because it contains sensitive data, <code>.ipynb_checkpoints</code> is ignored because it might accidentally have such data, and <code>__pycache__</code> is ignored not because it is a data cache (despite its name) but that it’s a commonly ignored development output in Python projects.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>See <a href="https://github.com/github/gitignore">GitHub’s collection</a> of commonly gitignored files and folders organized by programming language for more suggestions on files you might want to exclude from your repository. Not all these are related to sensitive information; some are output objects considered unnecessary or cluttering.</p>
</div>
</div>
</section>
<section id="dont-include-absolute-directories-that-are-not-accessible-to-others" class="level3" data-number="9.4.2">
<h3 data-number="9.4.2" class="anchored" data-anchor-id="dont-include-absolute-directories-that-are-not-accessible-to-others"><span class="header-section-number">9.4.2</span> Don’t Include Absolute Directories That Are Not Accessible to Others</h3>
<p>A common mistake in code is to hardcode a path that only exists on your computer, e.g.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"/users/malcolmbarrett/Downloads/data.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Prefer file paths that are relative to the root directory of your project. <code>data.csv</code> should be in my project directory, which I can access with relative paths:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"data/data.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For R users, the <a href="https://here.r-lib.org/">here</a> package can let you refer to files and folders from the root directory of your project no matter where the code exists. here can be helpful when, for instance, you have a report in a <code>reports/</code> folder but want to refer to a data file in the <code>data/</code> folder. Instead of backtracking <code>../data/data.csv</code>, you can write <code>here("data", "data.csv")</code></p>
</div>
</div>
</section>
<section id="be-clear-about-what-can-only-be-run-in-protected-environments" class="level3" data-number="9.4.3">
<h3 data-number="9.4.3" class="anchored" data-anchor-id="be-clear-about-what-can-only-be-run-in-protected-environments"><span class="header-section-number">9.4.3</span> Be Clear About What Can Only Be Run In Protected Environments</h3>
<p>Some projects can only be run in a protected environments, while others can be run without these restrictions, such as on a local laptop. Many lab projects, though, have components of both. For example, a microsimulation project might depend on summary statistics calculated from sensitive data. The calculations themselves likely need to occur in a protected computational environment like Nero GCP (<a href="05-computing.html#sec-nero" class="quarto-xref"><span>Section 5.1</span></a>). However, the simulation itself may not need to. If the summary data meets requirements in the data use agreement to be taken out of the protected environment, then the simulation itself may not need to occur there.</p>
<p>For these projects, we suggest:</p>
<ol type="1">
<li>Clearly documenting what requires a computational environment like Nero GCP</li>
<li>Checking qualifying derived data into the git repository. By qualifying, we mean derived products that meet the data use agreement policies for the study.</li>
</ol>
<p>While you can run such projects entirely in a protected environment, this approach allows you to use your local computer or HPC like Sherlock (<a href="05-computing.html#sec-sherlock" class="quarto-xref"><span>Section 5.2</span></a>) for the components that do not use protected data.</p>
</section>
</section>
<section id="sec-quarto" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="sec-quarto"><span class="header-section-number">9.5</span> Generate Reproducible Documents with Quarto</h2>
<p>Prefer using <a href="https://quarto.org/">Quarto</a> for documents, particularly those that generate a research product like a research plan or journal article. Quarto is a scientific publishing framework that weaves <a href="https://commonmark.org/help/tutorial/">Markdown-based</a> text with computational results from R, Python, Julia, etc. You can also mix languages in a single document.</p>
<p>You can also use Quarto interactively in RStudio and VS Code much as you can with R Markdown or Jupyter notebooks.</p>
<p>The documentation on the Quarto website is excellent, so check that for guidance on the latest features. A handy collection of pages for research is the <a href="https://quarto.org/docs/authoring/front-matter.html">Scholarly Writing</a> section of the Authoring guide.</p>
<p>For generating PDF documents with Quarto, you’ll need a TeX distribution. We recommend installing <a href="https://yihui.org/tinytex/">TinyTex</a>, which is a good general-purpose, lightweight distribution.</p>
<p>See our <a href="https://github.com/StanfordHPDS/training">trainings repository</a> for past Lab trainings on Quarto.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>RStudio comes with an installation of Quarto, so you likely don’t need to install it. However, if you install a newer version of Quarto, RStudio will use that automatically, making it reasonably seamless to upgrade.</p>
<p>If you prefer, you can also use R and <a href="https://quarto.org/docs/tools/vscode.html">Quarto in VS Code</a>.</p>
<p>Prefer Quarto over R Markdown; Quarto supersedes R Markdown and all significant improvements and developments will be there instead of R Markdown.</p>
<p>For rendering PDF documents, you can install TinyTex with the tinytex package:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>tinytex<span class="sc">::</span><span class="fu">install_tinytex</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Prefer Quarto <code>.qmd</code> files over Jupyter files; Quarto can run interactively like a notebook but has better reproducibility and version control properties. That said, you <em>can</em> use both using Quarto to <a href="https://quarto.org/docs/tools/jupyter-lab.html">render Jupyter files</a>. Quarto also has tooling for <a href="https://quarto.org/docs/tools/jupyter-lab.html#converting-notebooks">switching back and forth between formats</a>.</p>
<p>The best way to use Quarto for Python projects is <a href="https://quarto.org/docs/tools/vscode.html">VS Code</a> using the Quarto extension. This extension allows you to render files easily while also running code interactively. RStudio also supports Python projects, so it’s another good option if you also use R.</p>
</div>
</div>
</div>
</section>
<section id="sec-git-github" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="sec-git-github"><span class="header-section-number">9.6</span> Use Git and GitHub</h2>
<p>You should manage your project with version control and hosted for collaborators to access. We use <a href="https://www.atlassian.com/git">Git</a> and <a href="https://docs.github.com/en/get-started/start-your-journey/hello-world">GitHub</a> for managing and hosting version-controlled repositories, respectfully. We also have a <a href="https://github.com/StanfordHPDS">GitHub organization</a> where we keep team projects.</p>
<p>See <a href="08-code-review.html" class="quarto-xref"><span>Chapter 8</span></a> for how to manage code changes to your repository.</p>
<section id="git-workflow" class="level3" data-number="9.6.1">
<h3 data-number="9.6.1" class="anchored" data-anchor-id="git-workflow"><span class="header-section-number">9.6.1</span> Git Workflow</h3>
<ol type="1">
<li>From the beginning of a project, you should work in a git repository. You can either create one locally in your work environment and push to GitHub or create one <a href="https://docs.github.com/en/repositories/creating-and-managing-repositories/creating-a-new-repository">via GitHub</a> and clone it to your work environment. If you create one on GitHub, prefer creating it directly in our <a href="https://github.com/StanfordHPDS">GitHub organization</a> by changing the Owner to <code>StanfordHPDS</code>.</li>
<li>Make changes on branches. Prefer branch names that describe the intent of the change, e.g.&nbsp;<code>add-table</code> over <code>changes</code>.</li>
<li>Push the branch to GitHub, e.g.&nbsp;<code>git push -u origin add-table</code> for the <code>add-table</code> branch.</li>
<li>Open a <a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/creating-a-pull-request">pull request</a>.</li>
<li>Follow the code review process outlined in <a href="08-code-review.html" class="quarto-xref"><span>Chapter 8</span></a></li>
<li>When your pull request is merged into your new branch, pull the changes in your local copy of the repository, delete the remote branch, and delete the local branch.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For R users, there are two helpful functions in usethis to manage your git setup for a project: <code>usethis::use_git()</code> will initialize a git repository and activate the git UI in RStudio; <code>usethis::use_github()</code> will create and link a GitHub repository, as well as make your first push. Note that <code>use_github()</code> has an <code>organisation</code> argument where you can specify a GitHub organization to create the repository under, such as <code>use_github(organisation = "StanfordHPDS")</code>.</p>
<p>See also the <a href="https://usethis.r-lib.org/articles/pr-functions.html">PR workflow vignette</a> for making and managing pull requests in R. You might also find <a href="https://happygitwithr.com/">Happy Git and GitHub for the useR</a> a helpful perspective.</p>
</div>
</div>
</section>
<section id="transferring-repositories" class="level3" data-number="9.6.2">
<h3 data-number="9.6.2" class="anchored" data-anchor-id="transferring-repositories"><span class="header-section-number">9.6.2</span> Transferring Repositories</h3>
<p>If a repository for a Lab project exists on your personal account, <a href="https://docs.github.com/en/repositories/creating-and-managing-repositories/transferring-a-repository#transferring-a-repository-owned-by-your-personal-account">transfer it</a> to the <code>StanfordHPDS</code> GitHub organization.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Repositories that exist in a GitHub organization still contain information about your contributions. You can also <a href="https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-github-profile/customizing-your-profile/pinning-items-to-your-profile">pin organization repositories to your personal GitHub profile</a>.</p>
</div>
</div>
</section>
<section id="sec-gh-release" class="level3" data-number="9.6.3">
<h3 data-number="9.6.3" class="anchored" data-anchor-id="sec-gh-release"><span class="header-section-number">9.6.3</span> Release on GitHub</h3>
<p>GitHub has a mechanism for <a href="https://docs.github.com/en/repositories/releasing-projects-on-github/managing-releases-in-a-repository">making formal releases of repositories</a>. This takes a snapshot of the repository at the time of release and attaches a name.</p>
<p>Making a “release,” of course, has its origins in software versions. However, it’s also helpful in tracking significant milestones in a project. For instance, make a release upon submission to a journal and another upon publication. That allows you to easily revisit the state of the repository at those two time points. GitHub also makes downloading the repository in releases easy, making it an excellent point to direct people not using Git.</p>
</section>
</section>
<section id="documentation" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="documentation"><span class="header-section-number">9.7</span> Documentation</h2>
<p>The first step in documenting your code is writing clear, readable code. In other words, someone else should be able to read your code and understand what it’s doing. The best way to test this out is a code review: can somebody else understand your code? As discussed in <a href="#sec-naming" class="quarto-xref"><span>Section 9.3</span></a>, code that is itself readable is sometimes called <em>self-documenting</em> code. It’s not always possible and shouldn’t be the only type of documentation, but it’s an excellent goal to strive towards.</p>
<section id="a-note-about-comments" class="level3" data-number="9.7.1">
<h3 data-number="9.7.1" class="anchored" data-anchor-id="a-note-about-comments"><span class="header-section-number">9.7.1</span> A Note about Comments</h3>
<p>Comments exist in virtually every programming language because programming languages are for humans, not computers. Adding commentary is essential to making it understandable to a person.</p>
<p>That said, many comments are of two less helpful varieties: <a href="https://www.reddit.com/r/ProgrammerHumor/comments/8w54mx/code_comments_be_like/">what comments</a> and deodorant comments. “What” comments explain what the code is doing, usually redundantly. This type of comment is unnecessary because it’s clear from the code what is happening:</p>
<pre><code># add 1 and 2 together
1 + 2</code></pre>
<p><em>Deodorant</em> comments are added because the code is unclear. This idea comes from what Martin Fowler calls “<a href="https://en.wikipedia.org/wiki/Code_smell">code smells</a>”, a particular odor in code that suggests a more profound problem or lack of clarity.</p>
<blockquote class="blockquote">
<p>…comments aren’t a bad smell; indeed they are a sweet smell. The reason we mention comments here is that comments often are used as a deodorant.</p>
</blockquote>
<p>Sometimes, blocks of comments explain code that could be refactored to be more straightforward:</p>
<blockquote class="blockquote">
<p>When you feel the need to write a comment, first try to refactor the code so that any comment becomes superfluous</p>
</blockquote>
<p>Again, code comments are <em>not</em> bad. They are helpful and sometimes downright necessary. Some code is unavoidably complex, so context as to why and what the code is doing makes it more understandable.</p>
<p>When you get feedback in a code review that something is hard to understand, try to clarify the code, then add comments as necessary.</p>
</section>
<section id="sec-readme" class="level3" data-number="9.7.2">
<h3 data-number="9.7.2" class="anchored" data-anchor-id="sec-readme"><span class="header-section-number">9.7.2</span> <code>README</code></h3>
<p>A <code>README</code> file is commonly included in a project to explain how to use it or other relevant information. <code>README.md</code> files have <a href="https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/customizing-your-repository/about-readmes">special properties on GitHub</a>. These are text files that use markdown syntax. When you visit a repository on GitHub, the <code>README</code> is rendered and serves as a front page for your project. You can manually include a <code>README.md</code> file or render one with a <code>README.Rmd</code> or <code>README.qmd</code> file.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For R users, running <code>usethis::use_readme_md()</code> and <code>usethis::use_readme_rmd()</code> will create <code>README.md</code> and <code>README.Rmd</code>, respectively. You only need to pick one of these.</p>
</div>
</div>
<p>For our purposes, a <code>README</code> should include <em>at least</em>:</p>
<ul>
<li>A description of the project, such as an abstract</li>
<li>A brief explanation of the file structure of the repository</li>
<li>Details on how to run the code (<a href="#sec-running-code" class="quarto-xref"><span>Section 9.8</span></a>) in the project, such as installing dependencies, versions of R or Python for the project, etc.</li>
<li>Any other necessary information to understand or use the project</li>
</ul>
<p>You can see examples of <code>README</code> files in our lab <a href="https://github.com/StanfordHPDS">GitHub organization</a>.</p>
</section>
</section>
<section id="sec-running-code" class="level2" data-number="9.8">
<h2 data-number="9.8" class="anchored" data-anchor-id="sec-running-code"><span class="header-section-number">9.8</span> Running Code</h2>
<section id="use-a-blank-slate" class="level3" data-number="9.8.1">
<h3 data-number="9.8.1" class="anchored" data-anchor-id="use-a-blank-slate"><span class="header-section-number">9.8.1</span> Use a Blank Slate</h3>
<p>You should regularly run your code in a <em>blank slate</em>—running everything from scratch.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>By default, R stores and loads the interactive environment you use between R sessions. This is a bad default for reproducibility. Teach R not to do this by running this command once in your terminal:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">use_blank_slate</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Relatedly, your script should <em>not</em> contain <code>rm(list = ls())</code>. Using a blank slate and restarting your R session is the better approach because it <em>really</em> starts from scratch, whereas <code>rm(list = ls())</code> only clears objects in the global environment. See <a href="https://www.tidyverse.org/blog/2017/12/workflow-vs-script/">Project-Oriented Workflows</a> for a discussion on this.</p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>In Python, the primary way that people end up with environments that are out of sync with their code is by not <a href="https://academic.oup.com/gigascience/article/doi/10.1093/gigascience/giad113/7516267?login=false">regularly restarting their Jupyter kernel</a>. Instead, regularly restart the kernel and run all cells to make sure your code still works (and works as you expect).</p>
<p>Note that this applies only to Jupyter Notebooks. While Quarto uses the Jupyter kernel for running Python code, it always starts a new session when rendering.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Rendering a Quarto document always runs code from scratch by default.</p>
</div>
</div>
</section>
<section id="sec-pipelines" class="level3" data-number="9.8.2">
<h3 data-number="9.8.2" class="anchored" data-anchor-id="sec-pipelines"><span class="header-section-number">9.8.2</span> Pipelines</h3>
<p>Pipeline tools are software that manage the execution of code. What’s practical about this for research projects is that pipeline tools track the relationship between components in your project (meaning it knows which order to run things in automatically) and will only run those components when they are out of date (meaning you don’t necessarily need to rerun your entire project because you updated one part of the code). They are also very handy for reproducing code, because they only require a command or two to run the entire pipeline.</p>
<p>Pipeline tools are helpful for projects of any size, but they are particularly suited to complex or computationally intense projects.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>The best pipeline tool in R is the targets package. targets is a native R tool, making it easy to work with R objects. It works particularly well with Quarto and R Markdown, allowing you to reduce the amount of code in a report while managing it reproducibly.</p>
<p>targets has <a href="https://books.ropensci.org/targets/">excellent documentation and tutorials</a>, so we point you there for guidance.</p>
<p>It’s also possible to use tools like Make (see the Python tab) among others, with R, although we recommend targets for projects that are mostly R. For projects that are a mix of languages, Make may be a better fit.</p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>Python has several pipeline tools that are used in data engineering. For these larger data projects, these tools are sometimes called <em>orchestration</em> tools. That said, many of them are much more complex than is needed for a single research project.</p>
<p>For research projects, we recommend <a href="https://www.gnu.org/software/make/">GNU Make</a>. Make is one of the oldest and most popular pipeline tools–over 40 years old. It shows its age in some ways, but it’s also battle-tested. See <a href="https://third-bit.com/py-rse/automate.html">this tutorial</a> for an example of running an analysis with Make.</p>
</div>
</div>
</div>
</section>
<section id="provide-guidance-on-how-to-run-your-code" class="level3" data-number="9.8.3">
<h3 data-number="9.8.3" class="anchored" data-anchor-id="provide-guidance-on-how-to-run-your-code"><span class="header-section-number">9.8.3</span> Provide Guidance on How to Run Your Code</h3>
<p>Your <code>README</code> should include guidance on how to run your code. For instance, if there is a command to run the entire project, include information about that process (this is usually related to pipeline-managed code as discussed in <a href="#sec-pipelines" class="quarto-xref"><span>Section 9.8.2</span></a>). If you intend the user to run scripts in a particular order, describe how, but prefer using a pipeline tool to manage this instead.</p>
</section>
</section>
<section id="sec-pkg-env" class="level2" data-number="9.9">
<h2 data-number="9.9" class="anchored" data-anchor-id="sec-pkg-env"><span class="header-section-number">9.9</span> Lock your Package Versions</h2>
<p>Installing project dependencies is a part of running code, but its peculiarities for reproducibility merit some attention of its own.</p>
<p>Both packages within a language and languages themselves frequently change, making running code over time (as new versions are released) and space (the versions on your computer vs.&nbsp;someone else’s computer) difficult.</p>
<p>A vital check of this problem is code review. The reviewer serves as a proxy for being able to run your code somewhere else. If it doesn’t work for your reviewer, discuss and document the process to make it so.</p>
<p>There are also tools for installing versions of packages local to the project such that a project will always use identical package versions.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We leave it up to the project’s author <em>when</em> they activate a package environment manager. Sometimes, waiting while you iterate through a project, adding and removing dependencies as you go, is helpful. Sometimes, it’s easier to start in a controlled environment.</p>
<p>At the very least, your project should <em>end</em> in such a state. The last check for this is pre-submission (<a href="10-pre-flight-checklist.html" class="quarto-xref"><span>Chapter 10</span></a>).</p>
</div>
</div>
<p>Here are the tools we use for managing software versions.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>In R, use the <a href="https://rstudio.github.io/renv/articles/renv.html">renv</a> package to manage R package versions. renv is an interactive tool, so you should use it primarily in the console.</p>
<p>To initiate a project:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">init</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Among other things, this will create <code>renv.lock</code>, which needs to be included in your git repository.</p>
<p>Check a project’s dependency status with</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">status</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>And update the packages in your lock file with</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">snapshot</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>When you use renv, your project <code>README</code> should explain how to use it, e.g.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("renv")</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install the dependencies for the project</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">restore</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>One common problem in renv is that it keeps track of but does not manage the R version. If you need to switch between R versions, consider using <a href="https://github.com/r-lib/rig">rig</a>. Rig is not an R package but a separate software that lets you install and switch between R versions. On servers, <a href="https://support.posit.co/hc/en-us/articles/212364537-Using-multiple-versions-of-R-with-RStudio-Workbench-RStudio-Server-Pro">RStudio Workbench will let you change versions</a>, as well, provided that they are installed.</p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>Note: The Python ecosystem for managing environments is vast. See <a href="https://alpopkes.com/posts/python/packaging_tools/" class="uri">https://alpopkes.com/posts/python/packaging_tools/</a> for an overview.</p>
<p>We recommend <a href="https://docs.astral.sh/uv/getting-started/installation/">uv</a>. uv allows you to install packages, set up virtual environments, and control the version of Python. uv manages most of this for you and works well across operating systems. It’s also very fast.</p>
<p><code>uv init</code> will set up a uv environment for you, creating several files: <code>pyproject.toml</code>, <code>.python-version</code>, and <code>main.py</code>, as well as a few other files if they don’t already exist, such as a <code>README</code> and <code>.gitignore</code> file. Once you start adding packages to the project, uv will also generate a lock file with the resolved package dependencies (<code>uv.lock</code>) and a virtual environment with <a href="https://docs.python.org/3/library/venv.html">venv</a> in the <code>.venv/</code> directory.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new project called my_new_project</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> init my_new_project</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># or, from within an existing project, just run init</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> init</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># manually sync the virtual environment</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># mostly uv will handle this for you but it can be handy</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> sync</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># add a package to your environment</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co"># don't use pip! This will install from pip but manage the environment for you</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="ex">uv</span> add polars</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>To run scripts, use <code>uv run</code>. This is a drop-in replacement for <code>python script.py</code>; <code>uv run</code> always runs the script in the virtual environment for the project, so it is a good practice.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run a script in the virtual environment</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>uv run my_script.py</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>To manage Python versions, use <code>uv python</code></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install Python 3.12</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>uv python install <span class="fl">3.12</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># and set it as the Python version for the project</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>uv python pin <span class="fl">3.12</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>To run development tools like <code>ruff</code>, use <code>uvx</code>, which allows you to use such tools without adding them as dependencies to your project.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>uvx ruff <span class="bu">format</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
<p>See the <a href="https://docs.astral.sh/uv/getting-started/features/">documentation</a> for other commands, particularly those under the Python versions, projects, and tools headings.</p>
</section>
<section id="sec-opt-in" class="level2" data-number="9.10">
<h2 data-number="9.10" class="anchored" data-anchor-id="sec-opt-in"><span class="header-section-number">9.10</span> Opt-in Workflows</h2>
<p>Opt-in workflows are things we do not require for a project but for which we offer guidance. Such workflows also allow the team to experiment with new things and see what works for projects and when.</p>
<section id="sec-tests" class="level3" data-number="9.10.1">
<h3 data-number="9.10.1" class="anchored" data-anchor-id="sec-tests"><span class="header-section-number">9.10.1</span> Testing</h3>
<p>In scientific work, two types of code tests are useful: code expectations and data expectations. Code should <em>behave</em> the way you expect, and data should <em>exist</em> the way you expect. If that is not the case, you either have identified a problem with your code and data or a problem with your expectations.</p>
<p>Automating such tests in code expectations is helpful because you can run them whenever you have code or data changes. Moreover, you’re probably already probing these expectations informally in some form or another.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>You can write code tests using simple tools in base R like <code>stop()</code> and <code>stopifnot()</code>, but the most robust suite for testing code is the testthat package. While <a href="https://testthat.r-lib.org/">testthat</a> is designed for R packages, it’s also useful for testing functions in your analysis code. In addition to the testthat documentation, see the <a href="https://r-pkgs.org/">testing chapter of R Packages</a> for more.</p>
<p>There are several tools for testing data. Again, you can use simple logical statements with <code>stop()</code> and friends, but the most comprehensive tool in R for data quality checks is <a href="https://rstudio.github.io/pointblank/">pointblank</a>.</p>
<p>In RStudio, you can automate tests even when you’re not in a package by activating “package mode.” All this means is adding a <a href="https://r-pkgs.org/description.html"><code>DESCRIPTION</code> file</a>. To do this, run <code>usethis::use_description(check_name = FALSE)</code> and restart RStudio. Then, you can run any tests in the <code>test/</code> folder via the Build pane.</p>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>You can write code tests using simple tools in Python like <code>assert</code>, but there are also many libraries for formal testing. The most popular is <a href="https://docs.python.org/3/library/unittest.html">unittest</a>.</p>
<p>There are several tools for testing data. Again, you can use simple logical statements with <code>assert</code> and friends, but the most comprehensive tool in Python for data quality checks is <a href="https://rstudio.github.io/pointblank/">Great Expectations</a>.</p>
</div>
</div>
</div>
</section>
<section id="sec-docker" class="level3" data-number="9.10.2">
<h3 data-number="9.10.2" class="anchored" data-anchor-id="sec-docker"><span class="header-section-number">9.10.2</span> Docker</h3>
<p><a href="https://docs.docker.com/get-started/overview/">Docker</a> is a tool for reproducing not just the software and packages used in an analysis but the entire computational environment. As it’s got more of a learning curve, we do not currently require it for projects. However, consider it for projects where reproducibility is crucial or where you want to feel more confident that the code will be runable for many years. Docker can also be very helpful when you are working across computational environments or operating systems.</p>
<p>See our <a href="https://github.com/StanfordHPDS/training/tree/main/containers">training on containers</a> for an introduction to Docker.</p>
<p>Docker is a general tool that works with R, Python, and just about anything else you like to use. We have numerous images available specific to our workflows: https://hub.docker.com/u/stanfordhpds. See the GitHub repository that hosts the source files for these images for descriptions of the different flavors: https://github.com/StanfordHPDS/docker. Broadly: - <code>stanfordhpds/base</code> is the image all the others are based on. It comes with rig, uv, Quarto, git and gh, as well as a few additional essential tools. Note that it does <em>not</em> have R or Python installed. Instead, you should use uv or rig to install Python or R, respectively, in the <code>Dockerfile</code>. - <code>stanfordhpds/python-uv</code> and friends automatically detect the Python version and the virtual environment from a project’s uv files - <code>stanfordhpds/r-renv</code> and friends automatically detect the R version and the virtual environment from a project’s renv files - The <code>stanfordhpds/*-rstudio</code> flavors come with RStudio, which you can open in your browser - The <code>stanfordhpds/*-ssh</code> flavors come with ssh active, which you can open remotely in VS Code or Positron</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Alternatives to Docker Desktop
</div>
</div>
<div class="callout-body-container callout-body">
<p>Docker is actually two things: the open-source tools we use to run containers and Docker, Inc., a company. Docker and docker-engine are open-source tools under an open-source license. These work natively on Linux, and so, for instance, when we use Docker on Nero, we are solely using the open-source, open-licensed tool.</p>
<p>On Mac and Windows, however, Docker, Inc.&nbsp;offers Docker Desktop. Docker Desktop makes it easy to use the open-source tools on Mac and Windows, among other things, but it also comes with a different set of <a href="https://www.docker.com/legal/docker-subscription-service-agreement/">Terms of Service</a> that are more complex.</p>
<p>If you would like to avoid agreeing to Docker Desktop’s Terms of Service, you have two main options:</p>
<ol type="1">
<li>Use <a href="https://podman.io/">podman</a> (recommended). podman is entirely open source and comes with a tool similar to Docker Desktop to run containers on Mac and Windows. podman is largely a drop-in replacement for docker and, in fact, you can add <code>alias docker=podman</code> to your shell profile to make podman run instead of docker for a given docker command.</li>
<li>Run docker via a Linux virtual machine. See for instance <a href="https://unix.stackexchange.com/questions/667940/how-to-install-docker-engine-in-macos-without-docker-desktop">this set of options</a>. This option is more technically complex.</li>
</ol>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/08-code-review.html" class="pagination-link" aria-label="Code Review">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Code Review</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/10-pre-flight-checklist.html" class="pagination-link" aria-label="Pre-Flight Checklist for Publications">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Pre-Flight Checklist for Publications</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>